# 챕터 04: 응답 모델과 상태 코드

> **난이도**: ⭐⭐ (2/5) | **예상 학습 시간**: 2~3시간

---

## 개요

이 챕터에서는 API 응답을 체계적으로 관리하는 방법을 학습합니다.
응답 모델을 정의하여 민감한 정보를 필터링하고, 적절한 HTTP 상태 코드를 설정하며,
예외 상황을 우아하게 처리하는 방법을 익힙니다.

API를 잘 만든다는 것은 단순히 데이터를 돌려주는 것이 아니라,
**일관되고 안전하며 명확한 응답**을 제공하는 것입니다.

---

## 왜 응답 관리가 중요한가?

### 1. 보안 (Security)
- 비밀번호, 내부 ID 등 민감한 정보가 응답에 포함되면 보안 사고로 이어집니다.
- 응답 모델을 사용하면 어떤 필드가 노출되는지 명시적으로 제어할 수 있습니다.

### 2. 일관성 (Consistency)
- 모든 API 엔드포인트가 동일한 형식으로 응답하면 클라이언트 개발이 편해집니다.
- 상태 코드가 정확하면 클라이언트가 응답을 올바르게 처리할 수 있습니다.

### 3. 문서화 (Documentation)
- response_model을 지정하면 Swagger UI에 응답 스키마가 자동으로 표시됩니다.
- 프론트엔드 개발자가 API 문서만 보고도 응답 형태를 파악할 수 있습니다.

### 4. 에러 처리 (Error Handling)
- 예외 상황에서 적절한 에러 메시지를 반환하면 디버깅이 쉬워집니다.
- 사용자에게 무엇이 잘못되었는지 명확하게 알려줄 수 있습니다.

---

## 포함된 섹션

| 섹션 | 제목 | 핵심 내용 |
|------|------|-----------|
| [sec01-response-model](./sec01-response-model/) | 응답 모델 | response_model, 입력/출력 모델 분리, 필드 제외 |
| [sec02-status-codes](./sec02-status-codes/) | HTTP 상태 코드 | status_code, status 모듈, CRUD별 상태 코드 |
| [sec03-error-handling](./sec03-error-handling/) | 에러 처리 | HTTPException, 커스텀 예외 핸들러 |

---

## 학습 순서

```
sec01-response-model → sec02-status-codes → sec03-error-handling
```

1. **sec01**: 응답 모델을 정의하여 API 응답 형태를 제어합니다.
2. **sec02**: CRUD 각 동작에 적절한 HTTP 상태 코드를 설정합니다.
3. **sec03**: 예외 상황을 처리하고 일관된 에러 응답을 반환합니다.

---

## 사전 준비

- Ch03 (요청 본문과 Pydantic 모델)을 완료해야 합니다.
- Pydantic의 BaseModel 사용법을 이해하고 있어야 합니다.

```bash
# 필요한 패키지 (이전 챕터에서 설치했다면 생략 가능)
pip install fastapi uvicorn httpx
```

---

## 이 챕터를 마치면

- response_model을 사용하여 응답 데이터를 필터링할 수 있습니다.
- 입력 모델과 출력 모델을 분리하여 보안을 강화할 수 있습니다.
- CRUD 각 동작에 적절한 HTTP 상태 코드를 설정할 수 있습니다.
- HTTPException을 사용하여 에러를 체계적으로 처리할 수 있습니다.
- 커스텀 예외 핸들러를 등록하여 일관된 에러 응답을 만들 수 있습니다.
