# 챕터 10: 로깅 (Logging)

> **난이도**: ⭐⭐ ~ ⭐⭐⭐ (2~3/5)
> **선수 지식**: Ch06 미들웨어와 CORS 완료, Ch09 비동기 프로그래밍 권장
> **예상 학습 시간**: 3~4시간

---

## 개요

애플리케이션을 개발하고 운영하다 보면, "지금 서버에서 무슨 일이 일어나고 있는가?"를 파악해야 하는 순간이 반드시 찾아옵니다.
사용자가 에러를 보고했을 때, 성능이 저하되었을 때, 보안 이슈가 발생했을 때 -- 이 모든 상황에서 **로깅(Logging)**이 핵심적인 역할을 합니다.

### 로깅 파이프라인

```
애플리케이션 코드
    │
    ▼
┌──────────────────┐
│   Logger (로거)    │  ← 로그 메시지 생성
└──────┬───────────┘
       ▼
┌──────────────────┐
│  Handler (핸들러)  │  ← 로그를 어디로 보낼지 결정
└──────┬───────────┘
       ▼
┌──────────────────┐
│ Formatter (포매터) │  ← 로그의 출력 형식 결정
└──────┬───────────┘
       ▼
   출력 (콘솔, 파일, 외부 시스템)
```

이 챕터에서는 Python의 표준 `logging` 모듈을 사용하여 FastAPI 애플리케이션에
체계적인 로깅 시스템을 구축하는 방법을 학습합니다.

---

## 왜 로깅인가?

| 상황 | `print()` | `logging` |
|------|-----------|-----------|
| 디버깅 | 가능하지만 운영 시 제거 필요 | 레벨로 제어 가능 |
| 운영 환경 | 사용 불가 | 파일/외부 시스템으로 전송 가능 |
| 에러 추적 | 스택 트레이스 직접 관리 | `exc_info` 자동 포함 |
| 성능 분석 | 불가능 | 타임스탬프 자동 기록 |
| 요청 추적 | 불가능 | request_id로 추적 가능 |
| 구조화 | 문자열만 가능 | JSON 등 구조화된 포맷 지원 |

---

## 포함된 섹션

| 섹션 | 제목 | 난이도 | 핵심 내용 |
|------|------|--------|----------|
| sec01 | [로깅 기본](./sec01-logging-basics/concept.md) | ⭐⭐ (2/5) | Python logging 모듈, 로그 레벨, Logger/Handler/Formatter |
| sec02 | [구조화된 로깅](./sec02-structured-logging/concept.md) | ⭐⭐⭐ (3/5) | JSON 포맷 로그, request_id, 컨텍스트 로깅 |
| sec03 | [로깅 설정](./sec03-logging-configuration/concept.md) | ⭐⭐⭐ (3/5) | dictConfig, 파일 로깅, 로테이션, 환경별 설정 |

---

## 학습 순서

```
sec01-logging-basics → sec02-structured-logging → sec03-logging-configuration
```

1. **sec01**: Python `logging` 모듈의 기본 개념과 FastAPI에서의 활용법을 학습합니다.
2. **sec02**: JSON 포맷 로그와 request_id를 활용한 구조화된 로깅을 구현합니다.
3. **sec03**: `dictConfig`를 사용한 체계적인 로깅 설정과 환경별 로그 관리를 학습합니다.

각 섹션에서:
1. `concept.md`를 읽고 개념을 이해합니다.
2. `exercise.md`의 문제를 확인합니다.
3. `exercise.py`에서 TODO를 완성합니다.
4. `python exercise.py`로 테스트를 실행합니다.
5. 막히면 `solution.py`를 참고합니다.

---

## 사전 준비

```bash
# 필요한 패키지 설치 (FastAPI, Uvicorn은 이미 설치되어 있어야 합니다)
pip install fastapi uvicorn httpx
```

> **참고**: 이 챕터에서는 Python 표준 라이브러리의 `logging`, `json`, `uuid` 모듈만 사용합니다.
> 별도의 외부 패키지 설치가 필요하지 않습니다.

---

## 이 챕터를 마치면 할 수 있는 것

- Python `logging` 모듈의 Logger, Handler, Formatter 관계를 설명할 수 있다
- `print()` 대신 `logging`을 사용해야 하는 이유를 설명할 수 있다
- FastAPI 엔드포인트에서 적절한 로그 레벨로 로그를 남길 수 있다
- 요청 로깅 미들웨어를 구현하여 모든 HTTP 요청을 자동으로 기록할 수 있다
- JSON 포맷의 구조화된 로그를 생성할 수 있다
- `request_id`를 사용하여 요청 단위로 로그를 추적할 수 있다
- `dictConfig`를 사용하여 체계적으로 로깅을 설정할 수 있다
- 개발 환경과 운영 환경에 맞는 로깅 설정을 구분하여 적용할 수 있다
